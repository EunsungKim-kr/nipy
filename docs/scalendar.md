<p align="center">
    <img src="https://user-images.githubusercontent.com/23215270/74083252-335ccb00-4aa5-11ea-9045-3d87de5c70b2.png" width="500">
    <h1 align="center" style="font-size: 3em;">NiPy Docs</h1>
    <p align="center">
        <img src="https://img.shields.io/badge/python-v3.7-blue">
        <img src="https://img.shields.io/badge/license-MIT-green">
        <img src="https://img.shields.io/badge/test-passing-brightgreen">
    </p>
    <p><b>NiPy (Neis with ptrhon)</b>는 나이스와 연관된 수 많은 기능들을 제공합니다. Scalendar (학사 일정 불러오기) 또한 그 중 하나입니다. 이번 문서에서는 Scalendar에 대한 간단한 설명과 더불어 사용방법을 알려드립니다. 이번 문서를 읽고 숙지하신 후 여러분 만의 프로그램을 만들어 보시기 바랍니다.</p>
</p>

<br/>

## 일러두기

NiPy Scalendar를 활용하시면 나이스 서버를 통해 나이스 상에 등록된 학사 일정을 확인하실 수 있습니다. 단 NiPy 고유의 서버를 활용하는 것이 아니기에 나이스 측에서 홈페이지를 개편하거나 저에게 서버 사용 중단을 요청하면 더 이상 서비스 되지 않을 수 있는 점 참고 바랍니다.

또한 학사일정 데이터를 보다 편리하게 수정하실 수 있도록 급식 데이터는 나이스 서버로부터 받은 "그대로" 제공됩니다. 즉 <br/>와 같은 html의 개행 코드가 가공되지 않고 제공됩니다.

## 시작하기

NiPy Scalendar는 다음과 같은 모듈을 사용하기에 반드시 존재하여야 합니다.

- requests
- json
- bs4 (Beautifulsoup)

아래 목록의 모듈은 학사일정 정보를 엑셀이나 csv 형식으로 저장받고 싶을 경우 존재해야 하는 모듈입니다.

- openpyxl
- csv

위의 모듈들의 설치가 완료되면 본 NiPy의 깃허브 저장소에서 `nipy.py` 파일을 다운받아 원하는 프로젝트가 있는 폴더에 설치하시면 됩니다.

## Step.0 기초정보 설정 하기

NiPy Scalendar를 활용하기 위해선 우선 기초정보를 설정하여야 합니다. 기초정보는 급식 정보를 받아올 학교의 지역명, 학교 코드, 교급입니다.

```python
# 경기과학고등학교을 학사 일정 조회 학교로 지정합니다.
c = Scalendar("경기", "J100000447", "4")
```

위의 예시는 c 이라는 변수를 Scalendar 활용자로서 지정하며 경기도내에 있는 경기과학고등학교를 기본 조회 학교로 설정합니다.

| 매개변수(예시) | 이름         | 설명                                                                                                                         |
| -------------- | ------------ | ---------------------------------------------------------------------------------------------------------------------------- |
| 경기           | 교육청(지역) | 교육청 소재지를 입력합니다.<br/>시, 도를 제외한 두글자를 입력해 주세요.<br/>2자리의 문자열 자료형입니다.                     |
| J100000447     | 학교 코드    | 학교별 고유 코드입니다.                                                                                                      |
| 4              | 학교교급     | 학교교급 구분을 위한 매개변수입니다.<br/>1자리의 문자열 자료형입니다.<br/>(1) 유치원, (2) 초등학교, (3) 중학교, (4) 고등학교 |

## Step.1 한달치 일정 불러오기

NiPy Scalendar를 활용하면 한달치 일정과 일년치 일정을 불러올 수 있습니다. 하루치 학사일정 정보를 불러오는 함수는 `month()` 입니다.

```python
# 기본 설정된 학교의 일정 중 19년도 9월달 학사 일정을 출력합니다.
print(c.month("2019", "09"))
```

위의 예제는 경기도내에 있는 경기과고의 19년도 9월자 학사일정을 출력하는 예제 입니다.

| 매개변수(예시) | 이름     | 설명                                                            |
| -------------- | -------- | --------------------------------------------------------------- |
| 2019           | 조회년도 | 조회할 일정의 년도를 입력합니다.<br/>4자리 문자열 자료형입니다. |
| 09             | 조회월   | 조회할 일정의 월을 입력합니다.<br/>2자리 문자열 자료형입니다.   |

위의 매개변수를 올바르게 입력하시면 다음과 같은 결과를 받으실 수 있습니다.

```python
{'01': '학사일정이 존재하지 않습니다.', '02': '학사일정이 존재하지 않습니다.', '03': '학사일정이 존재하지 않습니다.', '04': '학사일정이 존재하지 않습니다.', '05': '학사일정이 존재하지  않습니다.', '06': '학사일정이 존재하지 않습니다.', '07': '토요휴업일', '08': '학사일정이 존재하지 않습니다.', '09': '학사일정이 존재하지 않습니다.', '10': '학사일정이 존재하지 않습니다.', '11': '학사일정이 존재하지 않습니다.', '12': '추석', '13': '추석', '14': '추석', '15': '학 사일정이 존재하지 않습니다.', '16': '학사일정이 존재하지 않습니다.', '17': '학사일정이 존재하지 않습니다.', '18': '학사일정이 존재하지 않습니다.', '19': '학사일정이 존재하지 않습니다.', '20': '학사일정이 존재하지 않습니다.', '21': '토요휴업일', '22': '학사일정이 존재하지 않습니 다.', '23': '학사일정이 존재하지 않습니다.', '24': '학사일정이 존재하지 않습니다.', '25': '학사일정이 존재하지 않습니다.', '26': '학사일정이 존재하지 않습니다.', '27': '학사일정이 존재하지 않습니다.', '28': '토요휴업일', '29': '학사일정이 존재하지 않습니다.', '30': '학사일정이  존재하지 않습니다.'}
```

반환되는 결과는 딕셔너리이며 키 값에 원하는 날짜를 입력하여 학사일정을 반환받으실 수 있습니다.

## Step.2 일년치 일정 불러오기

NiPy Scalendar를 활용하면 하루치 급식과 한달치 급식을 불러올 수 있습니다. 일년치 급식 정보를 불러오고 저장하는 함수는 `year()` 입니다.

```python
# 기본 설정된 학교의 일정 중 19년도 학사일정을 딕셔너리로 반환받습니다.
print(c.year("2019", "d"))
```

위의 예제는 경기도내에 있는 경기과고의 19년도 학사일정을 반환, 출력하는 예제 입니다.

| 매개변수(예시) | 이름     | 설명                                                                                       |
| -------------- | -------- | ------------------------------------------------------------------------------------------ |
| 2019           | 조회년도 | 조회할 일정의 년도를 입력합니다.<br/>4자리 문자열 자료형입니다.                            |
| d              | 출력종류 | 급식 정보를 저장할 출력 파일의 형식입니다.<br/>엑셀의 경우 `e` 딕셔너리의 경우 `d` 입니다. |

위의 매개변수를 올바르게 입력하시면 다음과 같은 결과를 받으실 수 있습니다.

```python
{'01': {'01': '겨울방학', '02': '겨울방학', '03': '겨울방학', '04': '겨울방학', '05': '겨울방학', '06': '겨울방학', '07': '겨울방학', '08': '겨울방학', '09': '겨울방학', '10': '겨울방학','11': '겨울방학', '12': '겨울방학', '13': '겨울방학', '14': '겨울방학', '15': '겨울방학', '16': '겨울방학', '17': '겨울방학', '18': '겨울방학', '19': '겨울방학', '20': '겨울방학', '21': '겨울방학', '22': '겨울방학', '23': '겨울방학', '24': '겨울방학', '25': '겨울방학', '26': '겨울방학', '27': '겨울방학', '28': '겨울방학', '29': '겨울방학', '30': '겨울방학', '31': '겨울방학'}, '02': {'01': '겨울방학', '02': '겨울방학', '03': '겨울방학', '04': '겨울방학', '05': '겨울방학', '06': '겨울방학', '07': '겨울방학', '08': '겨울방학', '09': '겨울방학', '10': '겨울방학', '11': '겨울방학', '12': '겨울방학', '13': '겨울방학', '14': '겨울방학', '15': '겨울방학', '16': '겨울방학', '17': '겨울방학', '18': '겨울방학', '19': '겨울방학', '20': '겨울방학', '21': '겨울방학', '22': '겨울방학', '23': '겨울방학', '24': '겨울방학', '25': '겨울방학', '26': '겨울방학', '27': '겨울방학', '28': '겨울방학', '29': '겨울방학'}, ~~ 중략 ~~ '12': {'01': '학사일정이 존재하지 않습니다.', '02': '학사일정이 존재하지 않습니다.', '03': '학사일정이 존재하지 않습니다.', '04': '학사일정이 존재하지 않습니다.', '05': '학사일정이 존재하지 않습니다.', '06': '학사일정이 존재하지 않습니다.', '07': '토요휴업일', '08': '학사일정이 존재하지 않습니다.', '09': '학사일정이 존재하지 않습니다.', '10': '학사일정이 존재하지 않습니다.', '11': '학사일정이 존재하지 않습니다.', '12': '학사일정이 존재하지 않습니다.', '13': '학사일정이 존재하지 않습니다.', '14': '토요휴업일', '15': '학사일정이 존재하지 않습니다.', '16': '학사일정이 존재하지 않습니다.', '17': '학사일정이 존재하지 않습니다.', '18': '학사일정이 존재하지 않습니다.', '19': '학사일정이 존재하지 않습니다.', '20': '종강식', '21': '겨울방학', '22': '겨울방학', '23': '겨울방학', '24': '겨울방학', '25': '겨울방학', '26': '겨울방학', '27': '겨울방학', '28': '겨울방학', '29': '겨울방학', '30': '겨울방학', '31': '겨울방학'}}
```

만일 딕셔너리로 내용을 받으신 경우 key 값에 날짜를 넣어 급식 정보를 반환받으실 수 있습니다.

## 에러코드

NiPy가 실행되던 중 문제가 발생하면 다음과 같은 에러코드가 반환됩니다.  
참고로 year를 이용하여 일년치 학사일정 정보를 반환 받은 경우 에러코드가 출력되지 않았으나 각 일정 내용에 에러코드가 표시된 경우가 있을 수 있습니다.

| 에러코드     | 제목                 | 설명                                                                                            |
| ------------ | -------------------- | ----------------------------------------------------------------------------------------------- |
| SERVER ERROR | 서버 접속 실패       | 나이스에 접속하지 못하였습니다.<br/>점검중이거나 교육청 측에서 차단할 경우 발생하는 문제입니다. |
| SIZE ERROR   | 매개변수 길이 에러   | 매개변수로 받은 문자열의 길이가 올바르지 않습니다.<br/>매뉴얼에 따라 입력해 주십시오.           |
| TYPE ERROR   | 매개변수 자료형 에러 | 매개변수로 받은 내용의 자료형이 올바르지 않습니다.<br/>매뉴얼에 따라 입력해 주십시오.           |
| NO DATABASE  | 학사일정 조회 실패   | 학사일정을 조회하지 못하였습니다.<br/>학교명이나 인터넷 상태를 확인해 주십시오.                 |
| OFFICE ERROR | 교육청 / 지역 에러   | 매개변수로 받은 지역이 올바르지 않습니다.<br/>매뉴얼에 따라 입력해 주십시오.                    |
| EXCEL ERROR  | 엑셀 변환 에러       | 한달치 급식을 엑셀에 저장하던 중 문제가 발생했습니다.<br/>모듈 상태등을 확인해 주십시오.        |
| DICT ERROR   | 딕셔너리 변환 에러   | 한달치 급식을 딕셔너리에 저장하던 중 문제가 발생했습니다.                                       |
